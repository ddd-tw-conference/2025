# 第11章：投影片下載系統

> **本章內容**：會眾投影片下載體驗、講者資源管理、多平台整合

---

## ✅ 系統完成狀態

投影片下載系統已完全開發完成並上線使用：

### 系統功能現況

- **議程整合**：投影片按鈕自動顯示在有講者的議程中
- **一鍵下載**：Google Drive 投影片可直接下載
- **多平台支援**：整合 Canva、Gamma、SlideShare 等第三方平台
- **即時生效**：新增投影片後立即可用

### 實際檔案狀態

- ✅ `config/slide-assets.ts` - 投影片資源配置檔
- ✅ `lib/segment-key.ts` - 議程識別工具
- ✅ `lib/slides.ts` - 投影片處理邏輯
- ✅ `components/segment-slide-action.tsx` - 下載按鈕元件
- ✅ 多語言翻譯 - 完整中英文支援

### 使用方式

**會眾體驗**：

- 在議程頁面點選任一議程
- 講者資訊下方會顯示投影片下載/檢視按鈕
- Google Drive 投影片直接下載，其他平台開新視窗檢視

### 技術特色

- **配置驅動**：所有投影片資源集中管理
- **類型安全**：TypeScript 完整型別檢查
- **響應式設計**：手機與桌面完美適配
- **多語支援**：所有文字完全國際化

---

## 🎯 系統概覽

投影片下載系統讓會眾可以輕鬆取得講者的簡報資料，提升會議參與體驗。

### 主要特色

- 📥 **簡化流程**：最多 2 次點擊完成下載
- 🔗 **深度整合**：投影片按鈕顯示在議程細節中
- 🌐 **多平台**：支援 Google Drive、Canva、Gamma、SlideShare
- 🎯 **智慧判斷**：自動區分可下載與僅檢視的投影片

---

## 📥 下載體驗

### 單一投影片

當議程只有一份投影片時：

- 直接顯示「下載投影片」或「檢視投影片」按鈕
- 顯示講者姓名與投影片標題
- 僅檢視的投影片會特別標註提示

### 多份投影片

當議程有多位講者、多份投影片時：

- 顯示「選擇投影片」按鈕
- 點擊後展開選單列出所有投影片
- 每份投影片都標示講者姓名

### 視覺設計

- **下載按鈕**：藍色漸層背景，白色文字
- **檢視按鈕**：藍色邊框，藍色文字
- **展開選單**：白色背景，帶陰影效果
- **講者標籤**：灰色背景，小字標示

---

## 🗂️ 投影片管理

### 支援的平台

| 平台 | 使用方式 | 會眾體驗 |
|------|----------|----------|
| **Google Drive** | 直接下載連結 | 點擊後自動下載檔案 |
| **Canva** | 檢視連結 | 開新視窗線上瀏覽 |
| **Gamma** | 檢視連結 | 開新視窗線上瀏覽 |
| **SlideShare** | 檢視連結 | 開新視窗線上瀏覽 |

### Google Drive 特殊處理

- 系統會自動轉換 Google Drive 連結
- 原本的預覽連結 → 直接下載連結
- 會眾不需額外點擊下載按鈕

---

## 🔧 新增投影片

### 步驟說明

#### 步驟 1：準備投影片連結

- 確認投影片已上傳至 Google Drive 或其他平台
- Google Drive 檔案需設定為「任何知道連結的人」可下載
- 複製完整的分享連結

#### 步驟 2：更新配置檔案

開啟 `config/slide-assets.ts` 檔案，新增投影片資訊：

```text
議程識別碼 (segmentKey)
講者代號 (speakerId)
投影片連結 (url)
平台類型 (gdrive/canva/gamma/slideshare)
標題翻譯碼 (titleKey)
```

#### 步驟 3：新增翻譯

在 `locales/zh-tw.json` 和 `locales/en.json` 中新增投影片標題翻譯

#### 步驟 4：測試確認

- 執行 `pnpm build` 確認無錯誤
- 開啟議程頁面檢查按鈕是否顯示
- 測試下載/檢視功能是否正常

---

## 📋 實際範例

### 範例議程：文件即程式碼 X 文件驅動開發

**講者**：陳建村 (Michael Chen)

**投影片設定**：

```text
議程識別碼：documentation-as-code-dac-x-document-driven-development
講者代號：michael-chen
投影片連結：https://drive.google.com/file/d/.../view
平台類型：gdrive
```

**會眾看到**：

- 「下載投影片」按鈕（藍色漸層）
- 講者：OOO
- 標題：文件即程式碼 X 文件驅動開發

**點擊後**：

- 瀏覽器自動下載投影片檔案
- 無需跳轉至 Google Drive 預覽頁

---

## 🔍 議程識別機制

### 自動識別邏輯

系統會從議程的英文標題自動產生識別碼：

1. 轉換為小寫
2. 移除括號和特殊符號
3. 空格轉換為連字號

### 識別範例

```text
英文標題：Documentation as Code (DaC) X Document-Driven Development
識別碼：documentation-as-code-dac-x-document-driven-development
```

### 注意事項

- 每個議程的英文標題必須唯一
- 投影片配置的識別碼必須與自動產生的完全一致
- 英文標題修改後，識別碼也會改變

---

## 🌍 多語言支援

### 翻譯內容

| 功能 | 繁體中文 | English |
|------|----------|---------|
| 下載按鈕 | 下載投影片 | Download Slide |
| 檢視按鈕 | 檢視投影片 | View Slide |
| 選擇按鈕 | 選擇投影片 | Choose Slide |
| 選單標題 | 可用投影片 | Available Slides |
| 講者標籤 | 講者 | Speaker |
| 檢視提示 | 此投影片僅供線上檢視 | View only |

### 投影片標題

每份投影片都需要中英文標題：

- 繁體中文：顯示給台灣使用者
- 英文：顯示給國際使用者

---

## 🎨 設計細節

### 按鈕樣式

- **主要動作**：藍紫漸層背景，視覺突出
- **次要動作**：藍色邊框，保持簡潔
- **滑鼠懸停**：顏色加深，提供互動回饋

### 展開選單

- 白色背景，帶有柔和陰影
- 每個選項之間有分隔線
- 滑鼠懸停時背景變淺灰色

### 響應式設計

- **手機**：按鈕全寬顯示，易於點擊
- **桌面**：按鈕寬度適中，對齊左側
- **選單**：自動調整寬度，不超出螢幕

---

## 📱 使用情境

### 情境 1：會議當天

會眾在現場聽講時：

1. 打開手機瀏覽會議網站
2. 進入議程頁面，找到正在進行的議程
3. 點擊下載投影片按鈕
4. 立即取得講者簡報，同步學習

### 情境 2：會後複習

會眾回家後想複習內容：

1. 再次訪問會議網站
2. 瀏覽所有議程的投影片
3. 下載感興趣的主題
4. 深度學習與實踐

### 情境 3：無法到場

無法參加會議的人：

1. 透過網站了解議程內容
2. 下載所有公開的投影片
3. 自主學習講者分享的知識

---

## ❓ 常見問答

**Q: 所有議程都會有投影片嗎？**
A: 不一定，講者可自行決定是否提供投影片。系統會自動判斷，沒有投影片的議程不會顯示按鈕。

**Q: 為什麼有些投影片只能檢視不能下載？**
A: 部分講者使用 Canva、Gamma 等線上簡報工具，這些平台不提供檔案下載，只能線上瀏覽。

**Q: 投影片會在會議前就公開嗎？**
A: 依講者意願而定，有些講者會提前上傳，有些會在演講後才提供。

**Q: 下載的投影片可以分享嗎？**
A: 請尊重講者的著作權，建議分享會議網站連結讓他人自行下載。

**Q: 手機下載投影片會存在哪裡？**
A: 依手機瀏覽器設定，通常會存在「下載」資料夾中。

---

## 🔧 維護說明

### 日常維護

- **更新連結**：講者提供新版本時，直接修改配置檔的連結
- **新增投影片**：依照新增步驟，加入配置檔與翻譯
- **移除投影片**：從配置檔中刪除該項目即可

### 權限檢查

**Google Drive 投影片**：

- 定期檢查檔案權限是否正確
- 確認設定為「任何知道連結的人」
- 避免檔案過期或被移除

**其他平台投影片**：

- 確認連結可正常訪問
- 檢查平台是否有維護或異常

### 建置發布

修改投影片配置後：

1. 執行 `pnpm build` 重新建置
2. 檢查是否有錯誤訊息
3. 部署至 GitHub Pages
4. 測試線上版本功能

---

## 🚀 未來可能優化

### 功能面

- **下載統計**：記錄哪些投影片最受歡迎
- **搜尋功能**：快速找到特定主題的投影片
- **收藏功能**：會眾可標記想下載的投影片

### 技術面

- **動態載入**：投影片清單改由 API 提供，無需重新建置
- **權限偵測**：自動檢查連結是否有效
- **快取機制**：已下載檔案可離線瀏覽

### 體驗面

- **預覽功能**：下載前可先預覽投影片內容
- **推薦系統**：根據會眾興趣推薦相關投影片
- **評分機制**：會眾可對投影片品質評分

---
