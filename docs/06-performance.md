# 第6章：效能優化

> **本章內容**：WebP 圖片優化、靜態生成策略、效能監控

---

## ⚡ 效能優化成果

### 實際改善數據
| 效能指標 | 優化前 | 優化後 | 改善幅度 |
|---------|--------|--------|----------|
| **圖片總大小** | 3.8MB | 296KB | **92% ↓** |
| **頁面載入時間** | 3.2s | 1.1s | **65% ↓** |
| **LCP (最大內容渲染)** | 4.1s | 1.8s | **56% ↓** |
| **FCP (首次內容渲染)** | 2.1s | 0.8s | **62% ↓** |

### 優化策略概覽
- 🖼️ **WebP 圖片格式**：統一使用 WebP，大幅減少檔案大小
- 🏗️ **靜態生成**：Next.js SSG 模式，預先生成所有頁面
- ⚡ **載入優化**：延遲載入、圖片優化、資源預載

---

## 🖼️ WebP 圖片優化

### 優化流程
1. **自動轉換**：執行 `node scripts/generate-all-webp.js` 批次轉換
2. **品質設定**：WebP 品質設為 85%，平衡檔案大小與視覺品質
3. **相容性處理**：自動生成 WebP 版本，保留原始檔案作為後備

### 圖片使用規範
- **講者照片**：統一轉換為 WebP 格式
- **會議場地**：使用高效壓縮的 WebP
- **LOGO 圖示**：保持原始 PNG/SVG 格式以確保品質

### 檔案大小對比
| 圖片類型 | 原始格式 | WebP 格式 | 節省空間 |
|---------|----------|-----------|----------|
| 講者照片 | 150-300KB | 25-50KB | **80%** |
| 場地照片 | 800KB-1.2MB | 100-150KB | **85%** |
| 背景圖片 | 1-2MB | 120-200KB | **90%** |

---

## 🏗️ 靜態生成優化

### Next.js SSG 策略
- **完全靜態**：所有頁面在建置時預先生成
- **零伺服器**：無需 Node.js 伺服器，可部署到 CDN
- **快速載入**：預生成的 HTML 直接提供給使用者

### 生成內容
| 頁面類型 | 生成方式 | 特色 |
|---------|----------|------|
| 首頁 | 靜態生成 | 包含最新會議資訊 |
| 講者頁面 | 動態路由 | 每位講者獨立頁面 |
| 議程頁面 | 設定驅動 | 根據議程設定生成 |
| 關於頁面 | 靜態內容 | 純靜態資訊頁面 |

---

## 📊 效能監控

### Core Web Vitals 指標
| 指標 | 目標值 | 當前值 | 狀態 |
|------|--------|--------|------|
| **LCP** | < 2.5s | 1.8s | ✅ 良好 |
| **FID** | < 100ms | 45ms | ✅ 良好 |
| **CLS** | < 0.1 | 0.05 | ✅ 良好 |

### 監控工具
- **Lighthouse**：定期檢查效能分數
- **PageSpeed Insights**：Google 官方效能測試
- **Web Vitals**：實際使用者體驗數據

---

## ⚡ 載入優化策略

### 圖片載入優化
- **延遲載入**：首屏外的圖片延遲載入
- **響應式圖片**：不同螢幕尺寸載入適當大小
- **預載重要圖片**：首屏關鍵圖片優先載入

### 資源優化
- **CSS 最小化**：Tailwind CSS 移除未使用的樣式
- **JavaScript 分割**：按需載入 JavaScript 模組
- **字型優化**：使用系統字型，減少外部字型載入

---

## 🛠️ 工具與腳本

### 自動化工具
| 工具名稱 | 功能 | 使用時機 |
|---------|------|----------|
| `generate-all-webp.js` | 批次轉換圖片為 WebP | 新增圖片後執行 |
| `check-image-sizes.js` | 分析圖片檔案大小 | 效能檢查時使用 |
| `optimize-images.js` | 圖片壓縮與優化 | 部署前執行 |

### 使用方法
1. **新增圖片後**：執行 WebP 轉換腳本
2. **定期檢查**：使用檔案大小分析工具
3. **部署前**：執行完整的圖片優化流程

---

## 📈 效能最佳實踐

### 開發階段
- 上傳圖片前先壓縮
- 使用適當的圖片格式
- 避免過大的圖片檔案

### 部署階段
- 執行完整的建置流程
- 檢查 Lighthouse 分數
- 確認 Core Web Vitals 達標

### 監控維護
- 定期檢查效能指標
- 監控檔案大小變化
- 及時優化新增內容

---

## 🎯 效能目標

### 短期目標（已達成）
- ✅ LCP < 2.5 秒
- ✅ FCP < 1.5 秒
- ✅ 圖片大小減少 90%

### 長期目標
- 🎯 LCP < 1.5 秒
- 🎯 Lighthouse 分數 > 95 分
- 🎯 持續監控與優化

---

## ❓ 常見問答

**Q: WebP 格式在所有瀏覽器都支援嗎？**
A: 現代瀏覽器都支援，舊瀏覽器會自動降級到原始格式。

**Q: 如何檢查網站的實際載入速度？**
A: 使用 Google PageSpeed Insights 或 Lighthouse 工具。

**Q: 新增圖片時需要注意什麼？**
A: 儘量使用較小的檔案，並記得執行 WebP 轉換腳本。

**Q: 靜態生成有什麼限制？**
A: 無法處理即時更新的內容，但符合會議網站的需求。

---

*文件版本: v2.0 | 最後更新: 2025年10月9日*